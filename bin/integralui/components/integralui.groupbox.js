/*
  filename: integralui.groupbox.js
  version : 1.4.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(d,c){function a(){this.constructor=d}for(var b in c)c.hasOwnProperty(b)&&(d[b]=c[b]);d.prototype=null===c?Object.create(c):(a.prototype=c.prototype,new a)},__decorate=this&&this.__decorate||function(d,c,a,b){var f=arguments.length,e=3>f?c:null===b?b=Object.getOwnPropertyDescriptor(c,a):b,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)e=Reflect.decorate(d,c,a,b);else for(var h=d.length-1;0<=h;h--)if(g=d[h])e=(3>f?g(e):3<f?g(c,a,e):
g(c,a))||e;return 3<f&&e&&Object.defineProperty(c,a,e),e},__metadata=this&&this.__metadata||function(d,c){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(d,c)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUIGroupBoxTags=function(){return function(){}}();IntegralUIGroupBoxTags=__decorate([core_1.Directive({selector:"iui-group-header"})],IntegralUIGroupBoxTags);
exports.IntegralUIGroupBoxTags=IntegralUIGroupBoxTags;
var IntegralUIGroupBox=function(d){function c(a,c,f){var b=d.call(this,a)||this;b.commonService=a;b.cmpResolver=c;b.baseService=f;b.expandState="none";b.isExpanded=!1;b.isSelected=!1;b.supressCallback=!1;b.contentHeight="0";b.contentDisplay="block";b.contentOpacity=1;b.maxBlockHeight=0;b.parentCtrl=null;b.contentClassName="";b.headerClassName="";b.headerExpandBoxClassName="";b.contentClass=[];b.headerBlockClass=[];b.afterCollapse=new core_1.EventEmitter;b.afterExpand=new core_1.EventEmitter;b.afterSelect=
new core_1.EventEmitter;b.beforeCollapse=new core_1.EventEmitter;b.beforeExpand=new core_1.EventEmitter;b.beforeSelect=new core_1.EventEmitter;b.selectedChanged=new core_1.EventEmitter;return b}__extends(c,d);Object.defineProperty(c.prototype,"expanded",{get:function(){return this.isExpanded},set:function(a){if(this.isExpanded!=a){var b=this;if(b.callBeforeEvent(a)){b.expandState=a?"expand":"collapse";var c=setTimeout(function(){"collapse"==b.expandState&&(b.expandState="none");clearTimeout(c)},300);
b.isExpanded=a;b.header.animationState=b.isExpanded?"expand":"collapse";b.updateContentClass();b.toggleContent()}}},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"selected",{get:function(){return this.isSelected},set:function(a){if(this.isSelected!=a){var b={cancel:!1,group:this.data};this.beforeSelect.emit(b);1!=b.cancel&&(this.isSelected=a,this.header&&(this.header.state=a?this.header.state|integralui_core_1.IntegralUIObjectState.selected:this.header.state&~integralui_core_1.IntegralUIObjectState.selected),
this.afterSelect.emit({group:this.data}),this.selectedChanged.emit({group:this.data}),this.updateHeaderBlockClass())}},enumerable:!0,configurable:!0});c.prototype.callBeforeEvent=function(a){var b=!0;this.parentCtrl&&this.parentCtrl.invokeEvent&&(b=this.parentCtrl.invokeEvent(a?"BEFORE_EXPAND":"BEFORE_COLLAPSE",this));b&&(b={cancel:!1,group:this.data},a?this.beforeExpand.emit(b):this.beforeCollapse.emit(b),b=!b.cancel);return b};c.prototype.callAfterEvent=function(a,b){var c={group:this.data};a?this.afterExpand.emit(c):
this.afterCollapse.emit(c);this.parentCtrl&&this.parentCtrl.invokeEvent&&this.parentCtrl.invokeEvent(a?"AFTER_EXPAND":"AFTER_COLLAPSE",this,b);return!0};c.prototype.ngOnInit=function(){this.parentCtrl=this.baseService.getComponent();this.generalClassName="iui-groupbox";this.headerClassName=this.generalClassName+"-header";this.headerExpandBoxClassName=this.headerClassName+"-expand-box";this.contentClassName=this.generalClassName+"-content";this.defaultStyle={general:{disabled:this.generalClassName+
"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},header:{general:{disabled:this.headerClassName+"-disabled",focused:this.headerClassName+"-focused",normal:this.headerClassName,hovered:this.headerClassName+"-hovered",selected:this.headerClassName+"-selected"},expandBox:this.headerExpandBoxClassName},content:{general:this.contentClassName,expanded:this.contentClassName+"-expand",collapsed:this.contentClassName+
"-collapse"}};this.updateStyle(this.controlStyle);this.updateControlClass();this.updateContentClass();this.updateHeaderBlockClass()};c.prototype.ngAfterContentInit=function(){var a=this,b=setTimeout(function(){if(a.contentElem){var c=a.contentElem.nativeElement.firstElementChild.cloneNode(!0);c.style.position="absolute";c.style.top="-9999999px";a.controlElem.nativeElement.append(c);a.maxBlockHeight=c.offsetHeight;c.remove()}clearTimeout(b)},100)};c.prototype.ngOnDestroy=function(){};c.prototype.onHeaderClick=
function(a){this.isEnabled&&1==a.buttons&&(this.parentCtrl&&this.parentCtrl.invokeMethod?this.parentCtrl.invokeMethod("SELECT_GROUP",this):(this.selected=!this.selected,this.expanded=!this.expanded))};c.prototype.collapse=function(){this.parentCtrl||(this.expanded=!1)};c.prototype.expand=function(){this.expanded=!0};c.prototype.toggle=function(){this.expanded=!this.expanded};c.prototype.toggleContent=function(){if(this.parentCtrl&&this.parentCtrl.invokeMethod)this.expanded?this.parentCtrl.invokeMethod("TOGGLE_GROUPS",
this):this.parentCtrl.invokeMethod("COLLAPSE_GROUP",this);else{var a=this,b=0,c=0;if(a.expanded){a.contentDisplay="block";var d=setInterval(function(){b<a.maxBlockHeight?(c=0==c?1:c+2,b+=c,a.contentHeight=b+"px"):(a.contentHeight="auto",a.expandState="none",a.callAfterEvent(!0),a.supressCallback=!1,clearInterval(d))},25)}else{a.maxBlockHeight=a.contentElem.nativeElement.offsetHeight;b=a.maxBlockHeight;var g=setInterval(function(){0<b?(c=0==c?1:c+2,b-=c,a.contentHeight=b+"px"):(a.contentDisplay="none",
a.contentHeight="0",a.expandState="none",a.callAfterEvent(),a.supressCallback=!1,clearInterval(g))},25)}}};c.prototype.getContentHeight=function(){return this.maxBlockHeight};c.prototype.setContentHeight=function(a){this.contentHeight=a};c.prototype.getControlStyle=function(){var a={};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};c.prototype.updateContentClass=function(){this.contentClass.length=0;this.contentClass.push(this.options.currentStyle.content.general);
0!=this.expanded?"expand"==this.expandState&&this.contentClass.push(this.options.currentStyle.content.expanded):"collapse"==this.expandState&&this.contentClass.push(this.options.currentStyle.content.collapsed)};c.prototype.getContentClass=function(){return this.contentClass};c.prototype.getContentStyle=function(a){return this.commonService.isString(a)?a:a?{general:this.commonService.isFieldAvailable(a.general,this.contentClassName),expanded:this.commonService.isFieldAvailable(a.expanded,this.contentClassName+
"-expand"),collapsed:this.commonService.isFieldAvailable(a.collapsed,this.contentClassName+"-collapse")}:{general:this.defaultStyle.content.general,expanded:this.defaultStyle.content.expanded,collapsed:this.defaultStyle.content.collapsed}};c.prototype.updateHeaderBlockClass=function(){this.headerBlockClass.length=0;this.headerBlockClass.push("iui-groupbox-header-block");this.selected&&this.headerBlockClass.push("iui-groupbox-header-marker-down")};c.prototype.getHeaderBlockClass=function(){return this.headerBlockClass};
c.prototype.getHeaderClass=function(){var a=this.headerClassName;return a=this.state&integralui_core_1.IntegralUIObjectState.disabled?a+(" "+this.options.currentStyle.header.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?a+(" "+this.options.currentStyle.header.focused):this.state&integralui_core_1.IntegralUIObjectState.selected?a+(" "+this.options.currentStyle.header.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered?a+(" "+this.options.currentStyle.header.hovered):
a+(" "+this.options.currentStyle.header.normal)};c.prototype.getHeaderGeneralStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.headerClassName),selected:this.commonService.isFieldAvailable(a.selected,
this.headerClassName+"-selected")}:{disabled:this.defaultStyle.header.general.disabled,focused:this.defaultStyle.header.general.focused,hovered:this.defaultStyle.header.general.hovered,normal:this.defaultStyle.header.general.normal,selected:this.defaultStyle.header.general.selected}};c.prototype.getHeaderStyle=function(a){return a?{general:this.getHeaderGeneralStyle(a.general),expandBox:this.commonService.isFieldAvailable(a.expandBox,this.headerExpandBoxClassName)}:{general:{disabled:this.defaultStyle.header.general.disabled,
focused:this.defaultStyle.header.general.focused,hovered:this.defaultStyle.header.general.hovered,normal:this.defaultStyle.header.general.normal,selected:this.defaultStyle.header.general.selected},expandBox:this.defaultStyle.header.expandBox}};c.prototype.getCurrentHeaderStyle=function(){return this.options.currentStyle.header};c.prototype.setOpacity=function(a){this.contentOpacity=a};c.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),header:this.getHeaderStyle(a.header),
content:this.getContentStyle(a.content)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,selected:this.defaultStyle.general.selected},header:{general:{disabled:this.defaultStyle.header.general.disabled,focused:this.defaultStyle.header.general.focused,hovered:this.defaultStyle.header.general.hovered,normal:this.defaultStyle.header.general.normal,selected:this.defaultStyle.header.general.selected},
expandBox:this.defaultStyle.header.expandBox},content:{general:this.defaultStyle.content.general,expanded:this.defaultStyle.content.expanded,collapsed:this.defaultStyle.content.collapsed}}};return c}(integralui_core_1.IntegralUIBaseComponent);__decorate([core_1.ViewChild("control",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGroupBox.prototype,"controlElem",void 0);
__decorate([core_1.ViewChild("content",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],IntegralUIGroupBox.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("content",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],IntegralUIGroupBox.prototype,"contentElem",void 0);__decorate([core_1.ViewChild("header"),__metadata("design:type",integralui_core_1.IntegralUIHeaderItem)],IntegralUIGroupBox.prototype,"header",void 0);
__decorate([core_1.Input(),__metadata("design:type",String)],IntegralUIGroupBox.prototype,"text",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],IntegralUIGroupBox.prototype,"icon",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],IntegralUIGroupBox.prototype,"expandBoxType",void 0);__decorate([core_1.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],IntegralUIGroupBox.prototype,"expanded",null);
__decorate([core_1.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],IntegralUIGroupBox.prototype,"selected",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"afterCollapse",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"afterExpand",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"afterSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"beforeCollapse",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"beforeExpand",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"beforeSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIGroupBox.prototype,"selectedChanged",void 0);
IntegralUIGroupBox=__decorate([core_1.Component({selector:"iui-groupbox",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()" #control>\n\t\t\t<div [ngClass]="getHeaderBlockClass()" >\n\t\t\t\t<iui-header [controlStyle]="getCurrentHeaderStyle()" [enabled]="enabled" [icon]="icon" [text]="text" (mouseDown)="onHeaderClick($event)" [animationType]="expandBoxType" #header>\n\t\t\t\t\t<ng-content select="iui-group-header"></ng-content>\n\t\t\t\t</iui-header>\n\t\t\t</div>\n\t\t\t<div [ngClass]="getContentClass()" [ngStyle]="{ \'border-width\': expanded ? \'1px\' : \'0\' + \'px\', display: contentDisplay, \'height\': contentHeight, \'opacity\': contentOpacity }" #content>\n\t\t\t\t<ng-content></ng-content>\n\t\t\t</div>\n\t\t</div>\n    ',inputs:"controlStyle data enabled name size state".split(" "),
encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],IntegralUIGroupBox);exports.IntegralUIGroupBox=IntegralUIGroupBox;