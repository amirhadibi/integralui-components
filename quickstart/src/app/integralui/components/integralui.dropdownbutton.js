/*
  filename: integralui.dropdownbutton.js
  version : 1.1.0
  Copyright Â© 2016-2018 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(f,a){function b(){this.constructor=f}for(var e in a)a.hasOwnProperty(e)&&(f[e]=a[e]);f.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)},__decorate=this&&this.__decorate||function(f,a,b,e){var d=arguments.length,c=3>d?a:null===e?e=Object.getOwnPropertyDescriptor(a,b):e,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)c=Reflect.decorate(f,a,b,e);else for(var h=f.length-1;0<=h;h--)if(g=f[h])c=(3>d?g(c):3<d?g(a,b,c):
g(a,b))||c;return 3<d&&c&&Object.defineProperty(a,b,c),c},__metadata=this&&this.__metadata||function(f,a){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(f,a)},core_1=require("@angular/core"),integralui_button_1=require("./integralui.button"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUIDropDownButton=function(f){function a(b,e){var a=f.call(this,b,e)||this;a.elemRef=
b;a.commonService=e;a.originalDropDownSettings={};a.dropDownSettings={};a.placementValue=integralui_core_1.IntegralUIPlacement.Right;a.openDirection=integralui_core_1.IntegralUIDirection.Below;a.buttonClass=[];a.itemClick=new core_1.EventEmitter;a.dropDownOpening=new core_1.EventEmitter;a.dropDownOpened=new core_1.EventEmitter;a.dropDownClosed=new core_1.EventEmitter;a.updateDropDownSettings();return a}__extends(a,f);a.prototype.ngOnInit=function(){this.generalClassName="iui-dropdown-button";this.buttonClassName=
this.generalClassName+"-btn";this.initStyle()};a.prototype.initStyle=function(){this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},button:{disabled:this.buttonClassName+"-disabled",focused:this.buttonClassName+"-focused",normal:this.buttonClassName,hovered:this.buttonClassName+"-hovered",selected:this.buttonClassName+"-selected"}};
this.updateStyle(this.controlStyle);this.updateControlClass();this.updateButtonClass()};a.prototype.ngAfterViewInit=function(){};Object.defineProperty(a.prototype,"placement",{get:function(){return this.placementValue},set:function(b){this.placementValue=b;this.updateAdjustment();this.refresh()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"direction",{get:function(){return this.openDirection},set:function(b){this.openDirection=b;this.updateAdjustment();this.refresh()},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"settings",{get:function(){return this.dropDownSettings},set:function(b){this.updateDropDownSettings(b)},enumerable:!0,configurable:!0});a.prototype.getAdjustmentValue=function(b){var a={top:0,right:0,bottom:0,left:0};b&&(a={top:this.commonService.isFieldAvailable(b.top,0),bottom:this.commonService.isFieldAvailable(b.bottom,0),right:this.commonService.isFieldAvailable(b.right,0),left:this.commonService.isFieldAvailable(b.left,0)});return a};a.prototype.updateDropDownSettings=
function(b){var a=this,d=setTimeout(function(){a.originalDropDownSettings=b?{adjustment:a.getAdjustmentValue(b.adjustment),appRef:a.commonService.isFieldAvailable(b.appRef,null),autoClose:a.commonService.isFieldAvailable(b.autoClose,!0),buttonType:1,direction:a.openDirection,enabled:a.commonService.isFieldAvailable(b.enabled,!0),inverse:!1,items:a.commonService.isFieldAvailable(b.items,[]),position:"manual",style:a.commonService.isFieldAvailable(b.style,a.getDefaultDropDownStyle())}:{adjustment:a.getAdjustmentValue(),
appRef:null,autoClose:!0,buttonType:1,direction:a.openDirection,enabled:!0,inverse:!1,items:[],position:"manual",style:a.getDefaultDropDownStyle()};a.dropDownSettings={adjustment:a.originalDropDownSettings.adjustment,appRef:a.originalDropDownSettings.appRef,autoClose:a.originalDropDownSettings.autoClose,buttonType:1,direction:a.originalDropDownSettings.direction,enabled:a.originalDropDownSettings.enabled,inverse:a.originalDropDownSettings.inverse,items:a.originalDropDownSettings.items,position:a.originalDropDownSettings.position,
style:a.originalDropDownSettings.style};a.updateAdjustment();clearTimeout(d)},1)};a.prototype.updateAdjustment=function(){var b={top:0,right:0,bottom:0,left:0};this.originalDropDownSettings&&this.originalDropDownSettings.adjustment&&(b={top:this.originalDropDownSettings.adjustment.top,right:this.originalDropDownSettings.adjustment.right,bottom:this.originalDropDownSettings.adjustment.bottom,left:this.originalDropDownSettings.adjustment.left});if(this.elemRef&&this.buttonElem){var a=this.commonService.getBorderWidth(this.elemRef.nativeElement.firstElementChild),
d=this.commonService.getMargin(this.elemRef.nativeElement.firstElementChild),c=this.commonService.getPadding(this.elemRef.nativeElement.firstElementChild);this.placementValue==integralui_core_1.IntegralUIPlacement.Left?this.openDirection&integralui_core_1.IntegralUIDirection.Left?(b.left=b.left-this.buttonElem.nativeElement.offsetWidth-(d.left+a.left+c.left)+1,this.openDirection&integralui_core_1.IntegralUIDirection.Below?b.top=b.top-this.buttonElem.nativeElement.offsetHeight-(d.top+a.top+a.bottom+
c.top+c.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(b.top+=1)):(this.openDirection&integralui_core_1.IntegralUIDirection.Right&&(b.left=b.left-this.buttonElem.nativeElement.offsetWidth-(d.left+a.left+c.left)),this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(b.top=b.top-this.buttonElem.nativeElement.offsetHeight-(d.top+a.top+a.bottom+c.top+c.bottom)+2)):this.openDirection&integralui_core_1.IntegralUIDirection.Right?(b.left+=d.right+a.right+c.right,this.openDirection&
integralui_core_1.IntegralUIDirection.Below?b.top=b.top-this.buttonElem.nativeElement.offsetHeight-(d.top+a.top+a.bottom+c.top+c.bottom)+1:this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(b.top+=1)):(b.left=this.openDirection&integralui_core_1.IntegralUIDirection.Left?b.left+(d.right+a.right+c.right):b.left-this.buttonElem.nativeElement.offsetWidth,this.openDirection&integralui_core_1.IntegralUIDirection.Above&&(b.top=b.top-this.buttonElem.nativeElement.offsetHeight-(d.top+a.top+a.bottom+
c.top+c.bottom)+2))}this.dropDownSettings&&(this.dropDownSettings.adjustment=b,this.dropDownSettings.direction=this.openDirection,this.dropDownSettings.inverse=this.placementValue!=integralui_core_1.IntegralUIPlacement.Left||this.openDirection&integralui_core_1.IntegralUIDirection.Right||!(this.openDirection&integralui_core_1.IntegralUIDirection.Above||this.openDirection&integralui_core_1.IntegralUIDirection.Below)?!1:!0)};a.prototype.onButtonContextMenu=function(a){a.preventDefault()};a.prototype.onDropDownItemClick=
function(a){this.itemClick.emit(a)};a.prototype.onDropDownOpening=function(a){this.dropDownOpening.emit(a)};a.prototype.onDropDownOpened=function(a){this.state|=integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownOpened.emit(a)};a.prototype.onDropDownClosed=function(a){this.state&=~integralui_core_1.IntegralUIObjectState.selected;this.refresh();this.dropDownClosed.emit(a)};a.prototype.getControlStyle=function(){var a={};0<this.ctrlSize.width&&(a.width=this.ctrlSize.width+
"px");0<this.ctrlSize.height&&(a.height=this.ctrlSize.height+"px");return a};a.prototype.getDefaultDropDownStyle=function(){return{general:{normal:"iui-dropdown-button-list"}}};a.prototype.updateButtonClass=function(){this.buttonClass.length=0;this.placementValue==integralui_core_1.IntegralUIPlacement.Left?(this.buttonClass.push(this.buttonClassName+"-left"),this.openDirection&integralui_core_1.IntegralUIDirection.Left?this.buttonClass.push(this.generalClassName+"-open-left"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&
this.buttonClass.push(this.generalClassName+"-open-above")):(this.buttonClass.push(this.buttonClassName+"-right"),this.openDirection&integralui_core_1.IntegralUIDirection.Right?this.buttonClass.push(this.generalClassName+"-open-right"):this.openDirection&integralui_core_1.IntegralUIDirection.Above&&this.buttonClass.push(this.generalClassName+"-open-above"));this.options.currentStyle&&(this.buttonClass.push(this.options.currentStyle.button.normal),this.state&integralui_core_1.IntegralUIObjectState.disabled?
this.buttonClass.push(this.options.currentStyle.button.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?this.buttonClass.push(this.options.currentStyle.button.focused):this.state&integralui_core_1.IntegralUIObjectState.selected?this.buttonClass.push(this.options.currentStyle.button.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered&&this.buttonClass.push(this.options.currentStyle.button.hovered))};a.prototype.getButtonClass=function(){return this.buttonClass};
a.prototype.getButtonStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.disabled,this.buttonClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.focused,this.buttonClassName+"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.buttonClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.buttonClassName),selected:this.commonService.isFieldAvailable(a.selected,this.buttonClassName+"-selected")}:
{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}};a.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),button:this.getButtonStyle(a.button)}:{general:{disabled:this.defaultStyle.general.disabled,focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,
selected:this.defaultStyle.general.selected},button:{disabled:this.defaultStyle.button.disabled,focused:this.defaultStyle.button.focused,hovered:this.defaultStyle.button.hovered,normal:this.defaultStyle.button.normal,selected:this.defaultStyle.button.selected}}};a.prototype.refresh=function(){var a=this,e=setTimeout(function(){a.updateStyle(a.controlStyle);a.updateControlClass();a.updateButtonClass();clearTimeout(e)},1)};return a}(integralui_button_1.IntegralUIButton);
__decorate([core_1.ViewChild("button"),__metadata("design:type",core_1.ElementRef)],IntegralUIDropDownButton.prototype,"buttonElem",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIDropDownButton.prototype,"placement",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],IntegralUIDropDownButton.prototype,"direction",null);
__decorate([core_1.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],IntegralUIDropDownButton.prototype,"settings",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"itemClick",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownOpening",void 0);
__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownOpened",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],IntegralUIDropDownButton.prototype,"dropDownClosed",void 0);
IntegralUIDropDownButton=__decorate([core_1.Component({selector:"iui-dropdown-button",template:'\n\t\t<div [ngClass]="getControlClass()" [ngStyle]="getControlStyle()">\n\t\t\t<ng-content></ng-content>\n\t\t\t<div [ngClass]="getButtonClass()" (contextmenu)="onButtonContextMenu($event)" [iuiContextMenu]="settings" (menuClick)="onDropDownItemClick($event)" (menuOpening)="onDropDownOpening($event)" (menuOpened)="onDropDownOpened($event)" (menuClosed)="onDropDownClosed($event)" #button>\n\t\t\t\t<span></span>\n\t\t\t</div>\n\t\t</div>\n\t',inputs:"controlStyle data enabled name size state".split(" "),
encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[core_1.ElementRef,integralui_common_service_1.IntegralUICommonService])],IntegralUIDropDownButton);exports.IntegralUIDropDownButton=IntegralUIDropDownButton;